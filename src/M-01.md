# Lines of code

- [UniswapV3Staker.sol#L340-L348](https://github.com/code-423n4/2023-05-maia/blob/54a45beb1428d85999da3f721f923cbf36ee3d35/src/uni-v3-staker/UniswapV3Staker.sol#L340-L348)
- [UniswapV3Staker.sol#L373-374](https://github.com/code-423n4/2023-05-maia/blob/54a45beb1428d85999da3f721f923cbf36ee3d35/src/uni-v3-staker/UniswapV3Staker.sol#L373-L374)

# Vulnerability details

One of the project assumptions is that anyone can call the `restakeToken` function on someone else's token after the incentive ends (at the start of the new gauge cycle). 

[UniswapV3Staker.sol#\_unstakeToken](https://github.com/code-423n4/2023-05-maia/blob/54a45beb1428d85999da3f721f923cbf36ee3d35/src/uni-v3-staker/UniswapV3Staker.sol#L373-L374):

```solidity
373:    // anyone can call restakeToken if the block time is after the end time of the incentive
374:    if ((isNotRestake || block.timestamp < endTime) && owner != msg.sender) revert NotCalledByOwner();
```

This assumption is broken because everywhere the `_unstakeToken` is called, the `isNotRestake` flag is set to `true`, including the [`restakeToken`](https://github.com/code-423n4/2023-05-maia/blob/54a45beb1428d85999da3f721f923cbf36ee3d35/src/uni-v3-staker/UniswapV3Staker.sol#L342) function. Because of that, when the caller is not the `deposit.owner`, the call will revert with `NotCalledByOwner()` error.

```
if ((isNotRestake || block.timestamp < endTime) && owner != msg.sender)
	_____________                                  ___________________
  always set to true                                   true as well
```
## Impact



## Proof of Concept



## Tools Used

Manual Review

## Recommended Mitigation Steps


